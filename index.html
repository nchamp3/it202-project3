<!DOCTYPE html>
<html>
  <head>
    <title>IT202-Project 3</title>
    </head>
  <body>

    <canvas id="myCanvas" width="1200" height="700"></canvas>

    <script>
      let c = document.getElementById("myCanvas");
      let ctx = c.getContext("2d");

      let background = new Image();
      // background.src = "./Eastern_Veil_Nebula.jpg";
      background.src = "./bg.jpg"

      let px = 100;
      let py = 100;
      let score = 0;
      let lives = 3;
      let level = 1;
      let circles = [];
      let i = 0;
      // let speed = Math.floor(Math.random() * 10) + level;
      let radius = 20;
      let cwidth = c.width;
      let cheight = c.height;

      // clear the canvas
      // ctx.clearRect(0, 0, c.width, c.height);
      // background.onload = function(){
      //     ctx.drawImage(background,0,0);
      // }

      const createCircle = (t) => {
        let circle = {};
        circle.x = cwidth;
        circle.y = Math.random() * cheight;
        circle.type = t;
        circle.speed =  Math.floor(Math.random() * 10) + level;
        circles.push(circle);
      }

      const draw = (circle) => {
        //Start drawing
        ctx.beginPath();

        //Draw an arc. Arguments are x (pixels), y (pixels), radius (pixels), startPoint (radians), endPoint (radians)
        ctx.arc(circle.x, circle.y, radius, 0, Math.PI * 2);
        if(circle.type == "b") {
          ctx.fillStyle = "lightgreen";
        }
        else {
          ctx.fillStyle = "red";
        }
        ctx.closePath();
        //Fill our arc/circle!
        ctx.fill();
      }

      const move = (circle) => {
        circle.x = circle.x - circle.speed;
        // console.log(circle.x);

        if(circle.x < 0)
        {
          circle.x = cwidth;
          circle.y = Math.random() * cheight;
          circle.speed =  Math.floor(Math.random() * 10) + level;
        }
      }

      for (i = 1; i <= 4 ; i++){
        createCircle("b");
      }

      for (i = 1; i <= 2; i++){
        createCircle("h");
      }


      const gameController = () => {

        ctx.clearRect(0, 0, c.width, c.height);

        ctx.drawImage(background,0,0);

        console.log("Run");



        for(c of circles)
        {
          draw(c);
          move(c);
        }

        window.requestAnimationFrame(gameController);

      }

      // gameController();
      window.requestAnimationFrame(gameController);





    </script>

  </body>
</html>
